<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Order Status ‚Äì Madhavi Enterprises</title>
  <style>
    /* --- same CSS as before --- */
    body { font-family: 'Segoe UI', Arial, sans-serif; background:#f3f6fa; margin:0; padding:0; }
    header.site-header { background:#fff; padding:1rem 2rem; box-shadow:0 2px 8px rgba(0,0,0,0.08); }
    nav.nav-bar a { margin-right:1rem; text-decoration:none; color:#333; font-weight:500; }
    nav.nav-bar a:hover { color:#0066c0; }
    main { max-width:600px; margin:2rem auto; background:#fff; border-radius:12px; padding:1.5rem; box-shadow:0 2px 12px rgba(0,0,0,0.07); }
    h1 { color:#0066c0; margin-bottom:1.5rem; text-align:center; }
    .order-box { border:1px solid #e6eefc; border-radius:8px; padding:1rem; }
    .order-success { font-weight:bold; margin-bottom:0.7rem; text-align:center; }
    .order-status { background:#e5f1ff; padding:0.5rem 1rem; border-radius:6px; margin-bottom:1rem; display:inline-block; }
    .order-info, .order-items, .order-total { margin-bottom:1rem; }
    .order-items ul { list-style:none; padding:0; margin:0; }
    .order-items li { border-bottom:1px solid #eee; padding:0.4rem 0; }
    .btn { display:inline-block; background:#0066c0; color:#fff; padding:0.6rem 1.2rem; border-radius:6px; text-decoration:none; margin-top:1rem; }
    .btn:hover { background:#004a8f; }
    .admin-btn { margin-left:1rem; background:#444; }
    .empty-order { text-align:center; color:#888; font-size:1.1rem; margin:2rem 0; }
  </style>
</head>
<body>
  <header class="site-header">
    <nav class="nav-bar">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="products.html">Products</a>
      <a href="confirmation.html">Final</a>
      <a href="cart.html" class="cart-link">
        Cart <span class="cart-count">0</span>
      </a>
    </nav>
  </header>
  <main>
    <h1>Order Status</h1>
    <div class="order-box" id="order-box">
      <!-- Order details will appear here -->
    </div>
    <a href="products.html" class="btn">‚Üê Continue Shopping</a>
    <a href="admin.html" id="admin-btn" class="btn admin-btn" style="display:none;">View Admin Orders</a>
  </main>

  <script type="module">
    function updateCartCount() {
      document.querySelectorAll('.cart-count').forEach(span => {
        span.textContent = 0;
      });
    }

    function renderOrder() {
      const box = document.getElementById('order-box');
      const orders = JSON.parse(localStorage.getItem("orders") || "[]");

      if (orders.length === 0) {
        box.innerHTML = "<div class='empty-order'>No recent order found.<br><a href='products.html'>Shop now</a></div>";
        document.getElementById('admin-btn').style.display = "none";
        return;
      }

      // Show the most recent order (first in array)
      const order = orders[0];
      displayOrder(order);
    }

    function displayOrder(order) {
      const box = document.getElementById('order-box');
      let payment =
        order.paymentMethod === "cod"
          ? "Cash on Delivery"
          : order.paymentMethod === "card"
          ? "Credit/Debit Card"
          : "UPI";

      let itemsHtml = (order.cart || [])
        .map((item) => `<li>${item.name} √ó ${item.qty}</li>`)
        .join("");

      box.innerHTML = `
        <div class="order-success">üéâ Thank you, your order has been placed!</div>
        <div class="order-status">Order Status: <b>${order.status || "Pending"}</b></div>
        <div class="order-info">
          <b>Name:</b> ${order.name || ""}<br>
          <b>Address:</b> ${(order.address || "").replace(/\n/g, "<br>")}<br>
          <b>Payment:</b> ${payment}${order.paymentMethod === "upi" && order.upiTxnId
            ? `<br><b>UPI Txn ID:</b> ${order.upiTxnId}` : ""}<br>
          <b>Order Time:</b> ${order.orderTime || ""}
        </div>
        <div class="order-items">
          <b>Items:</b>
          <ul>${itemsHtml}</ul>
        </div>
        <div class="order-total">Total Paid: ‚Çπ${order.total || 0}</div>
      `;
      document.getElementById('admin-btn').style.display = "inline-block";
      updateCartCount();
    }

    document.addEventListener("DOMContentLoaded", renderOrder);
  </script>
</body>
</html>
